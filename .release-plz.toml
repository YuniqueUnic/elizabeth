[workspace]
# 工作区级别的默认配置
changelog_update = true  # 启用 changelog 自动更新
dependencies_update = false  # 不自动更新依赖
git_release_enable = false  # 禁用 GitHub 发布（可根据需要启用）
git_tag_enable = true  # 启用 git 标签
publish = false  # 默认不发布到 crates.io（可根据需要启用）
semver_check = true  # 启用 semver 检查
pr_branch_prefix = "release-plz-"  # PR 分支前缀
pr_labels = ["release"]  # 为发布 PR 添加标签
release_always = false  # 只在合并发布 PR 时发布，而不是每次提交都发布
publish_timeout = "10m"  # 设置 cargo publish 超时时间为 10 分钟

# 配置触发发布的提交类型
release_commits = "^(feat|fix|perf|refactor|docs|style|test|chore|build|ci):"

# 配置 changelog
[changelog]
protect_breaking_commits = true  # 始终在 changelog 中包含破坏性更改的提交
header = """
# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]
"""
body = """
## [{{ version }}]{%- if release_link -%}({{ release_link }}){% endif %} - {{ timestamp | date(format="%Y-%m-%d") }}
{% for group, commits in commits | group_by(attribute="group") %}
### {{ group | upper_first }}
{% for commit in commits %}
{%- if commit.scope -%}
- *({{commit.scope}})* {% if commit.breaking %}[**breaking**] {% endif %}{{ commit.message }}{%- if commit.links %} ({% for link in commit.links %}[{{link.text}}]({{link.href}}) {% endfor -%}){% endif %}
{%- else -%}
- {% if commit.breaking %}[**breaking**] {% endif %}{{ commit.message }}{% endif -%}
{% endfor -%}
{% endfor %}
"""
trim = true

# 为 board 包配置特定设置
[[package]]
name = "board"
changelog_path = "CHANGELOG.md"  # 使用根目录的 CHANGELOG
changelog_update = true
publish = false  # 暂时不发布到 crates.io
semver_check = true
version_group = "elizabeth"  # 版本组，确保 workspace 中的包使用相同版本